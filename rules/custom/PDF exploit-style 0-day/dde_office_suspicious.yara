rule Office_DDE_Suspicious
{
    meta:
        description = "Suspicious DDEAUTO patterns in Office files"
        author = "rakavi"
        severity = "high"

    strings:
        $dde1 = "DDEAUTO" ascii nocase
        $dde2 = "DDE" ascii nocase
        $cmd = "cmd.exe" ascii nocase
        $ps = "powershell" ascii nocase
        $calc = "calc.exe" ascii nocase

    condition:
        (uint16(0) == 0xD0CF or uint32(0) == 0x504B0304) and
        $dde1 and ( $cmd or $ps or $calc )
}
