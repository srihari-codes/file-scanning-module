rule ZeroDay_Heur_Office_Exploit_Shellcode
{
    meta:
        description = "Office file with big high-entropy stream + shellcode markers (generic 0-day style)"
        author = "rakavi"
        severity = "high"

    strings:
        $call_pop1 = { E8 00 00 00 00 5? }  // call + pop reg
        $jmpesp1  = { FF E4 }              // jmp esp
        $b64blob  = /[A-Za-z0-9+\/]{300,}={0,2}/

    condition:
        (uint16(0) == 0xD0CF or uint32(0) == 0x504B0304) and
        ( $b64blob or $call_pop1 or $jmpesp1 ) and
        filesize < 10MB
}
