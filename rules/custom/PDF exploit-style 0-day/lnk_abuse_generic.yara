rule LNK_Abuse_Generic
{
    meta:
        description = "Shortcut file abusing cmd/powershell"
        author = "rakavi"
        severity = "medium"

    strings:
        $lnk_header = { 4C 00 00 00 }  // beginning of .lnk (not very strict)
        $cmd = "cmd.exe /c" ascii nocase
        $ps1 = "powershell.exe" ascii nocase
        $ps2 = "PowerShell -" ascii nocase

    condition:
        $lnk_header at 0 and ( $cmd or $ps1 or $ps2 )
}
