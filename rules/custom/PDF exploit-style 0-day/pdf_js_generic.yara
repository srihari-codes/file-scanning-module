rule PDF_Embedded_JavaScript_Generic
{
    meta:
        description = "PDF with embedded JavaScript or suspicious actions"
        author = "rakavi"
        severity = "medium"

    strings:
        $pdf_header = "%PDF" ascii
        $js1 = "/JS" ascii
        $js2 = "/JavaScript" ascii
        $aa = "/AA" ascii      // additional actions
        $open = "/OpenAction" ascii
        $launch = "/Launch" ascii

    condition:
        $pdf_header at 0 and
        (1 of ($js*) or 1 of ($aa, $open, $launch))
}
