import "pe"

rule ZeroDay_Heur_Kernel_Exploit_Win
{
    meta:
        description = "Heuristic: PE using low-level Nt* syscall set (possible LPE/0-day)"
        author = "rakavi"
        severity = "high"

    strings:
        $nt1 = "NtQuerySystemInformation" ascii
        $nt2 = "NtQueryInformationToken" ascii
        $nt3 = "NtSetInformationProcess" ascii
        $nt4 = "NtMapViewOfSection" ascii
        $nt5 = "RtlAdjustPrivilege" ascii
        $drv = ".sys" ascii

    condition:
        pe.is_pe and
        uint16(0) == 0x5A4D and
        3 of ($nt*) and
        $drv
}
